(function(d){"undefined"!==typeof module&&"undefined"!==typeof module.exports&&"undefined"!==typeof require?module.exports=d():window.PickFile=d()})(function(){var d=function(a){a=a||{};this.options={datatype:"Text",onLoad:function(){},onError:function(){}};for(var b in a)this.options[b]=a[b];"string"===typeof this.options.el?this.el=document.querySelector(this.options.el):this.options.el&&"innerHTML"in this.options.el&&(this.el=this.options.el);this.el||(this.el=document.createElement("div"));this.el.innerHTML=
this.template;this.els={};for(a=0;a<this.elements.length;a+=1)this.els[this.elements[a]]=this.el.querySelector(".pickfile-"+this.elements[a]);this.els.fileselect.addEventListener("change",this.onFileSelect.bind(this),!1);this.els.loadbtn.addEventListener("click",this.onLoadbtnClick.bind(this),!1);this.xhr=new XMLHttpRequest;this.xhr.upload?(this.els.filedrop.addEventListener("dragover",this.onFiledropHover.bind(this),!1),this.els.filedrop.addEventListener("dragleave",this.onFiledropHover.bind(this),
!1),this.els.filedrop.addEventListener("drop",this.onFileSelect.bind(this),!1)):this.els.filedrop.style.display="none"};d.prototype={elements:["fileselect","filedrop","loadbtn","url"],template:'<div class="pickfile"><form><input class="pickfile-url" type="text" placeholder="type or paste remote URL here"><button class="pickfile-loadbtn btn btn-primary">Load</button><div class="pickfile-filedrop">or Drop file here</div><div class="pickfile-fileinputs btn btn-primary"><input class="pickfile-fileselect" type="file">or Choose file</div></form></div>',
onFiledropHover:function(a){a.stopPropagation();a.preventDefault();a.target.className=("dragover"==a.type?"hover ":"")+a.target.className.replace("hover ","")},onFileSelect:function(a){this.onFiledropHover(a);for(var a=a.target.files||a.dataTransfer.files,b=0,c;c=a[b];b++)this.parseFile(c)},onLoadbtnClick:function(a){a.preventDefault();var b=new XMLHttpRequest,c=this.els.url.value;c&&(b.onreadystatechange=function(){if(4==b.readyState)if(200==b.status)b.url=c,this.options.onLoad(b.response,b);else this.options.onError(b.statusText,
b)}.bind(this),b.open("GET",this.els.url.value,!0),b.responseType="BinaryString"===this.options.datatype?"blob":this.options.datatype.toLowerCase(),b.send())},parseFile:function(a){var b="readAs"+this.options.datatype,c=new FileReader;b in c&&(c.onload=function(b){this.options.onLoad(b.target.result,a)}.bind(this),c[b](a))}};return d});
